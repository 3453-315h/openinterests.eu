{% import "_sources.html" as sources %}
{% extends "layout.html" %}

{% block title %}
    {% if relation.get_attribute('title_text') %}
        {{relation['title_text'].value}}; {{relation.schema.label}} ({{relation.target['name'].value}})
    {% else %}
        {{relation.schema.label}}: {{relation.source['name'].value}} - {{relation.target['name'].value}}
    {% endif %}
{% endblock %}

{% block description %}
  {{ (relation['grant_subject'].value or relation['contract_description'].value or "An " + relation.schema.label + " between " + relation.source['name'].value + " and " + relation.target['name'].value + " as part of OpenInterests, a catalogue of interests regarding the institutions of the European Union.")
    | striptags | truncate(length=155) | trim | safe }}
{% endblock %}

{% block content %}
    <h2>{{relation.schema.label}}</h2>

    {% if relation.source.has_schema('eu_body') or relation.source.has_schema('eu_body') %}
        <p>Request detailed information via <a href="{{ relation | relation_wob_link }}">AskTheEU.org</a>.</p>
    {% endif %}

    <table class="table table-condensed">
        <tr>
            <th width="40%" class="attributes">Origin</th>
            <td colspan="2"><a href="{{url_for('entities.view', id=relation.source.id)}}">{{relation.source['name'].value}}</a></td>
        </tr>
        <tr>
            <th width="40%" class="attributes">Destination</th>
            <td colspan="2"><a href="{{url_for('entities.view', id=relation.target.id)}}">{{relation.target['name'].value}}</a></td>
        </tr>
        {% for prop in relation.active_properties if not relation.get_attribute(prop.name).hidden %}            
            <tr>
                <th width="40%" class="attributes">{{relation.get_attribute(prop.name).label}}</th>
                <td>{{prop.value | safe}}</td>
                <td class="source">{{ sources.link(prop) }}</td>
            </tr>
        {% endfor %}
    </table>
{% endblock %}

{% block js %}{% endblock %}
